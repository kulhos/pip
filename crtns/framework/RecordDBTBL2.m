 ; 
 ; **** Routine compiled from DATA-QWIK Filer RecordDBTBL2 ****
 ; 
 ; 02/24/2010 18:40 - pip
 ; 
 ;
 ; Record Class code for table DBTBL2
 ;
 ; Generated by PSLRecordBuilder on 02/24/2010 at 18:40 by
 ;
vcdmNew() ; 
 N vOid
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=BYPASS
 ;*** Start of code by-passed by compiler
 S vOid=$O(vobj(""),-1)+1,vobj(vOid,-1)="RecordDBTBL2",vobj(vOid,-2)=0,vobj(vOid)=""
 S vobj(vOid,-3)=""
 S vobj(vOid,-4)=""
 ;*** End of code by-passed by compiler ***
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=SCOPE
 Q vOid
 ;
vRCgetRecord0(v1,v2,vfromDbSet) ; 
 N vOid
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=BYPASS
 ;*** Start of code by-passed by compiler
 S vOid=$O(vobj(""),-1)+1,vobj(vOid,-1)="RecordDBTBL2"
 S vobj(vOid)=$G(^DBTBL(v1,2,v2))
 I vobj(vOid)="",'$D(^DBTBL(v1,2,v2))
 S vobj(vOid,-2)=1
 I $T K vobj(vOid) S $ZE="0,"_$ZPOS_",%PSL-E-RECNOFL,,DBTBL2",$EC=",U1001,"
 S vobj(vOid,-3)=v1
 S vobj(vOid,-4)=v2
 ;*** End of code by-passed by compiler ***
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=SCOPE
 Q vOid
 ;
vRCgetRecord1(v1,v2,vfromDbSet) ; 
 N vOid
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=BYPASS
 ;*** Start of code by-passed by compiler
 S vOid=$O(vobj(""),-1)+1,vobj(vOid,-1)="RecordDBTBL2"
 S vobj(vOid)=$G(^DBTBL(v1,2,v2))
 I vobj(vOid)="",'$D(^DBTBL(v1,2,v2))
 S vobj(vOid,-2)='$T
 S vobj(vOid,-3)=v1
 S vobj(vOid,-4)=v2
 ;*** End of code by-passed by compiler ***
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=SCOPE
 Q vOid
 ;
vRCgetRecord0Opt(v1,v2,vfromDbSet,v2out) ; 
 N dbtbl2
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=BYPASS
 ;*** Start of code by-passed by compiler
 S dbtbl2=$G(^DBTBL(v1,2,v2))
 I dbtbl2="",'$D(^DBTBL(v1,2,v2))
 S v2out=1
 I $T S $ZE="0,"_$ZPOS_",%PSL-E-RECNOFL,,DBTBL2",$EC=",U1001,"
 ;*** End of code by-passed by compiler ***
 Q dbtbl2
 ;
vRCgetRecord1Opt(v1,v2,vfromDbSet,v2out) ; 
 N dbtbl2
 ;  #ACCEPT DATE=02/26/2008; PGM=Dan Russell; CR=30801; Group=BYPASS
 ;*** Start of code by-passed by compiler
 S dbtbl2=$G(^DBTBL(v1,2,v2))
 I dbtbl2="",'$D(^DBTBL(v1,2,v2))
 S v2out='$T
 ;*** End of code by-passed by compiler ***
 Q dbtbl2
 ;
vBypassSave(this) ; 
 D vSave(this,"/NOJOURNAL/NOTRIGAFT/NOTRIGBEF/NOVALDD/NOVALREQ/NOVALRI/NOVALST",0)
 Q 
 ;
vSave(this,vRCparams,vauditLogSeq) ; 
 N vRCaudit N vRCauditIns
 N %O S %O=$G(vobj(this,-2))
 I ($get(vRCparams)="") S vRCparams="/CASDEL/INDEX/JOURNAL/LOG/TRIGAFT/TRIGBEF/UPDATE/VALDD/VALFK/VALREQ/VALRI/VALST/"
 I (%O=0) D
 .	D AUDIT^UCUTILN(this,.vRCauditIns,11,"|")
 .	D vRCsetDefaults(this)
 .	I (("/"_vRCparams_"/")["/VALREQ/") D vRCchkReqForInsert(this)
 .	I (("/"_vRCparams_"/")["/VALDD/") D vRCvalidateDD(this,%O)
 .	D vRCmiscValidations(this,vRCparams,%O)
 .	D vRCupdateDB(this,%O,vRCparams,.vRCaudit,.vRCauditIns)
 .	Q 
 E  I (%O=1) D
 .	Q:'$D(vobj(this,-100)) 
 .	D AUDIT^UCUTILN(this,.vRCaudit,11,"|")
 .	I ($D(vobj(this,-100,"1*","LIBS"))&($P($E($G(vobj(this,-100,"1*","LIBS")),5,9999),$C(124))'=vobj(this,-3)))!($D(vobj(this,-100,"2*","SID"))&($P($E($G(vobj(this,-100,"2*","SID")),5,9999),$C(124))'=vobj(this,-4))) D vRCkeyChanged(this,vRCparams,.vRCaudit) Q 
 .	I (("/"_vRCparams_"/")["/VALREQ/") D vRCchkReqForUpdate(this)
 .	I (("/"_vRCparams_"/")["/VALDD/") D vRCvalidateDD1(this)
 .	D vRCmiscValidations(this,vRCparams,%O)
 .	D vRCupdateDB(this,%O,vRCparams,.vRCaudit,.vRCauditIns)
 .	Q 
 E  I (%O=2) D
 .	I (("/"_vRCparams_"/")["/VALREQ/") D vRCchkReqForInsert(this)
 .	I (("/"_vRCparams_"/")["/VALDD/") D vRCvalidateDD(this,%O)
 .	D vRCmiscValidations(this,vRCparams,2)
 .	Q 
 E  I (%O=3) D
 .	  N V1,V2 S V1=vobj(this,-3),V2=vobj(this,-4) Q:'($D(^DBTBL(V1,2,V2))) 
 .	D vRCdelete(this,vRCparams,.vRCaudit,0)
 .	Q 
 Q 
 ;
vcheckAccessRights() ; 
 Q ""
 ;
vinsertAccess(userclass) ; 
 Q 1
 ;
vinsertOK(this,userclass) ; PUBLIC access is allowed, no restrict clause
 Q 1
 ;
vupdateAccess(userclass) ; 
 Q 1
 ;
vupdateOK(this,userclass) ; PUBLIC access is allowed, no restrict clause
 Q 1
 ;
vdeleteAccess(userclass) ; 
 Q 1
 ;
vdeleteOK(this,userclass) ; PUBLIC access is allowed, no restrict clause
 Q 1
 ;
vselectAccess(userclass,restrict,from) ; 
 S (restrict,from)=""
 Q 1
 ;
vselectOK(this,userclass) ; PUBLIC access is allowed, no restrict clause
 Q 1
 ;
vselectOptmOK(userclass,dbtbl2,vkey1,vkey2) ; PUBLIC access is allowed, no restrict clause
 Q 1
 ;
vgetLogging() ; 
 Q "0"
 ;
logUserclass(operation) ; 
 I (operation="INSERT") Q 0
 E  I (operation="UPDATE") Q 0
 E  I (operation="DELETE") Q 0
 E  I (operation="SELECT") Q 0
 Q 0
 ;
vlogSelect(statement,using) ; 
 Q 0
 ;
columnList() ; 
 N columns S columns=""
 S columns=columns_"APL,BUFFERS,CSCMP,CURDSP,DATE,DESC,DESC2,FORMHDG,LASTFID,LIBS,LNK1,LNK10,LNK11,LNK12,LNK13,LNK14,LNK15,LNK16,LNK17,LNK18,"
 S columns=columns_"LNK19,LNK2,LNK20,LNK21,LNK22,LNK23,LNK24,LNK25,LNK26,LNK27,LNK28,LNK3,LNK4,LNK5,LNK6,LNK7,LNK8,LNK9,NORPC,OOE,"
 S columns=columns_"OUTFMT,PFID,PROJ,PX,PY,REPEAT,REPREQ,RESFLG,RHTMAR,RULER,SCRCLR,SCRMOD,SID,STATUS,SYS,UID,VER,VIDEO,VPGM,XORIGIN,"
 S columns=columns_"YORIGIN,"
 Q $$vStrRep("APL,BUFFERS,CSCMP,CURDSP,DATE,DESC,DESC2,FORMHDG,LASTFID,LIBS,LNK1,LNK10,LNK11,LNK12,LNK13,LNK14,LNK15,LNK16,LNK17,LNK18,LNK19,LNK2,LNK20,LNK21,LNK22,LNK23,LNK24,LNK25,LNK26,LNK27,LNK28,LNK3,LNK4,LNK5,LNK6,LNK7,LNK8,LNK9,NORPC,OOE,OUTFMT,PFID,PROJ,PX,PY,REPEAT,REPREQ,RESFLG,RHTMAR,RULER,SCRCLR,SCRMOD,SID,STATUS,SYS,UID,VER,VIDEO,VPGM,XORIGIN,YORIGIN",",",$char(9),0,0,"")
 ;
columnListBM() ; 
 Q ""
 ;
columnListCMP() ; 
 Q $$vStrRep("",",",$char(9),0,0,"")
 ;
getColumnMap(map) ; 
 ;
 S map(-4)="SID:T:"
 S map(-3)="LIBS:T:"
 S map(-1)="DESC2:T:1"
 S map(0)="APL:T:11;CSCMP:L:22;CURDSP:L:18;DATE:D:3;DESC:T:9;NORPC:L:4;OOE:L:17;OUTFMT:T:14;PFID:U:1;PROJ:N:13;REPEAT:N:7;REPREQ:T:5;RESFLG:N:16;SCRCLR:N:8;SCRMOD:L:6;SYS:T:12;UID:T:15;VER:T:10;VPGM:T:2"
 S map("v1")="LNK1:U:1;LNK10:U:10;LNK11:U:11;LNK12:U:12;LNK13:U:13;LNK14:U:14;LNK15:U:15;LNK16:U:16;LNK17:U:17;LNK18:U:18;LNK19:U:19;LNK2:U:2;LNK20:U:20;LNK21:U:21;LNK22:U:22;LNK23:U:23;LNK24:U:24;LNK25:U:25;LNK26:"
 S map("v1")=map("v1")_"U:26;LNK27:U:27;LNK28:U:28;LNK3:U:3;LNK4:U:4;LNK5:U:5;LNK6:U:6;LNK7:U:7;LNK8:U:8;LNK9:U:9"
 S map("v5")="BUFFERS:N:5;FORMHDG:T:10;LASTFID:T:11;PX:N:9;PY:N:8;RHTMAR:N:13;RULER:T:3;STATUS:N:12;VIDEO:T:4;XORIGIN:N:2;YORIGIN:N:1"
 Q 
 ;
vlegacy(processMode,params) ; 
 N vTp
 I (processMode=2) D
 .	N dbtbl2 S dbtbl2=$$vRCgetRecord0^RecordDBTBL2(LIBS,SID,0)
 .	S vobj(dbtbl2,-2)=2
 . S vTp=($TL=0) TS:vTp (vobj):transactionid="CS" D vSave^RecordDBTBL2(dbtbl2,$$initPar^UCUTILN(params)) K vobj(dbtbl2,-100) S vobj(dbtbl2,-2)=1 TC:vTp  
 .	K vobj(+$G(dbtbl2)) Q 
 Q 
 ;
vhasLiterals() ; 
 Q 0
 ;
vRCmiscValidations(this,vRCparams,processMode) ; 
 I (("/"_vRCparams_"/")["/VALST/")  N V1,V2 S V1=vobj(this,-3),V2=vobj(this,-4) I '(''($D(^DBTBL(V1,2,V2)))=''processMode) D
 .	N errmsg
 .	I (+processMode'=+0) S errmsg=$$^MSG(7932)
 .	E  S errmsg=$$^MSG(2327)
 .	D throwError(errmsg)
 .	Q 
 Q 
 ;
vRCupdateDB(this,processMode,vRCparams,vRCaudit,vRCauditIns) ; 
  S:'$D(vobj(this,0)) vobj(this,0)=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),0)),1:"")
 I '(("/"_vRCparams_"/")["/NOUPDATE/") D
 .  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),3)=$P($H,",",1)
 .	I '(+$P($G(vobj(this,-100,0,"UID")),$C(124),2)&($P($E($G(vobj(this,-100,0,"UID")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),15)))  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),15)=$E($$USERNAM^%ZFUNC,1,20)
 .	N n
 .	S n=-1
 .	F  S n=$order(vobj(this,n)) Q:(n="")  D
 ..		I n="v5" D  Q 
 ...			;    #ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602; GROUP=BYPASS
 ...			;*** Start of code by-passed by compiler
 ...			S ^DBTBL(vobj(this,-3),2,vobj(this,-4),-5)=vobj(this,"v5")
 ...			;*** End of code by-passed by compiler ***
 ...			Q 
 ..		I n="v1" D  Q 
 ...			;    #ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602; GROUP=BYPASS
 ...			;*** Start of code by-passed by compiler
 ...			S ^DBTBL(vobj(this,-3),2,vobj(this,-4),-1)=vobj(this,"v1")
 ...			;*** End of code by-passed by compiler ***
 ...			Q 
 ..		Q:'($D(vobj(this,n))#2) 
 ..		;    #ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602; GROUP=BYPASS
 ..		;*** Start of code by-passed by compiler
 ..		S ^DBTBL(vobj(this,-3),2,vobj(this,-4),n)=vobj(this,n)
 ..		;*** End of code by-passed by compiler ***
 ..		Q 
 .	;   #ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602; GROUP=BYPASS
 .	;*** Start of code by-passed by compiler
 .	if $D(vobj(this)) S ^DBTBL(vobj(this,-3),2,vobj(this,-4))=vobj(this)
 .	;*** End of code by-passed by compiler ***
 .	Q 
 Q 
 ;
vRCdelete(this,vRCparams,vRCaudit,isKeyChange) ; 
 I '$get(isKeyChange),$D(vobj(this,-100)) D throwError("Deleted object cannot be modified")
 ;  #ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602; Group=BYPASS
 ;*** Start of code by-passed by compiler
 kill ^DBTBL(vobj(this,-3),2,vobj(this,-4))
 ;*** End of code by-passed by compiler ***
 Q 
 ;
vRCsetDefaults(this) ; 
  S:'$D(vobj(this,0)) vobj(this,0)=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),0)),1:"")
 I ($P(vobj(this,0),$C(124),22)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),22)=0
 I ($P(vobj(this,0),$C(124),18)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),18)=0
 I ($P(vobj(this,0),$C(124),3)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),3)=$P($H,",",1)
 I ($P(vobj(this,0),$C(124),4)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),4)=0
 I ($P(vobj(this,0),$C(124),17)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),17)=1
 I ($P(vobj(this,0),$C(124),14)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),14)="VT220"
 I ($P(vobj(this,0),$C(124),7)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),7)=0
 I ($P(vobj(this,0),$C(124),5)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),5)=0
 I ($P(vobj(this,0),$C(124),16)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),16)=0
 I ($P(vobj(this,0),$C(124),8)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),8)=1
 I ($P(vobj(this,0),$C(124),6)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),6)=0
 I ($P(vobj(this,0),$C(124),15)="")  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),15)=$$USERNAM^%ZFUNC
 Q 
 ;
vRCchkReqForInsert(this) ; 
  S:'$D(vobj(this,0)) vobj(this,0)=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),0)),1:"")
 I ($P(vobj(this,0),$C(124),22)="") D vRCrequiredErr("CSCMP")
 I ($P(vobj(this,0),$C(124),18)="") D vRCrequiredErr("CURDSP")
 I (vobj(this,-3)="") D vRCrequiredErr("LIBS")
 I ($P(vobj(this,0),$C(124),4)="") D vRCrequiredErr("NORPC")
 I ($P(vobj(this,0),$C(124),17)="") D vRCrequiredErr("OOE")
 I ($P(vobj(this,0),$C(124),6)="") D vRCrequiredErr("SCRMOD")
 I (vobj(this,-4)="") D vRCrequiredErr("SID")
 Q 
 ;
vRCchkReqForUpdate(this) ; 
  S:'$D(vobj(this,0)) vobj(this,0)=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),0)),1:"")
 I (vobj(this,-3)="") D vRCrequiredErr("LIBS")
 I (vobj(this,-4)="") D vRCrequiredErr("SID")
 I ($D(vobj(this,-100,0))>9) D
 .	I ($D(vobj(this,-100,0,"NORPC"))&($P($E($G(vobj(this,-100,0,"NORPC")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),4))),($P(vobj(this,0),$C(124),4)="") D vRCrequiredErr("NORPC")
 .	I ($D(vobj(this,-100,0,"SCRMOD"))&($P($E($G(vobj(this,-100,0,"SCRMOD")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),6))),($P(vobj(this,0),$C(124),6)="") D vRCrequiredErr("SCRMOD")
 .	I ($D(vobj(this,-100,0,"OOE"))&($P($E($G(vobj(this,-100,0,"OOE")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),17))),($P(vobj(this,0),$C(124),17)="") D vRCrequiredErr("OOE")
 .	I ($D(vobj(this,-100,0,"CURDSP"))&($P($E($G(vobj(this,-100,0,"CURDSP")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),18))),($P(vobj(this,0),$C(124),18)="") D vRCrequiredErr("CURDSP")
 .	I ($D(vobj(this,-100,0,"CSCMP"))&($P($E($G(vobj(this,-100,0,"CSCMP")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),22))),($P(vobj(this,0),$C(124),22)="") D vRCrequiredErr("CSCMP")
 .	Q 
 ; Node "1*" - only one required column
 I ($D(vobj(this,-100,"1*","LIBS"))&($P($E($G(vobj(this,-100,"1*","LIBS")),5,9999),$C(124))'=vobj(this,-3))),(vobj(this,-3)="") D vRCrequiredErr("LIBS")
 ; Node "2*" - only one required column
 I ($D(vobj(this,-100,"2*","SID"))&($P($E($G(vobj(this,-100,"2*","SID")),5,9999),$C(124))'=vobj(this,-4))),(vobj(this,-4)="") D vRCrequiredErr("SID")
 Q 
 ;
vRCrequiredErr(column) ; 
 N ER S ER=0
 N RM S RM=""
 D SETERR^DBSEXECU("DBTBL2","MSG",1767,"DBTBL2."_column)
 I ER D throwError($get(RM))
 Q 
 ;
vRCforceLoad(this) ; 
 N n S n=""
 N vn
 ;  #ACCEPT DATE=04/22/04; PGM=Dan Russell; CR=20602; Group=BYPASS
 ;*** Start of code by-passed by compiler
 for  set n=$order(^DBTBL(vobj(this,-3),2,vobj(this,-4),n)) quit:n=""  s vn=$S(n<0:"v"_-n,1:n) if '$D(vobj(this,vn)),$D(^DBTBL(vobj(this,-3),2,vobj(this,-4),n))#2 set vobj(this,vn)=^(n)
 ;*** End of code by-passed by compiler ***
 Q 
 ;
vRCvalidateDD(this,processMode) ; 
 N ER S ER=0
 N RM S RM=""
 N errmsg N X
 I (processMode=2) D vRCforceLoad(this)
 I ($D(vobj(this,"v5"))#2) D
 .	 S:'$D(vobj(this,"v5")) vobj(this,"v5")=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),-5)),1:"")
 .	I '($P(vobj(this,"v5"),$C(124),5)=""),'(+$P(vobj(this,"v5"),$C(124),5)=$P(vobj(this,"v5"),$C(124),5))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),5)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),5))
 .	S X=$P(vobj(this,"v5"),$C(124),5) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("BUFFERS",$$^MSG(742,"N"))
 .	I ($L($P(vobj(this,"v5"),$C(124),10))>40) D vRCvalidateDDerr("FORMHDG",$$^MSG(1076,40))
 .	I ($L($P(vobj(this,"v5"),$C(124),11))>12) D vRCvalidateDDerr("LASTFID",$$^MSG(1076,12))
 .	I '($P(vobj(this,"v5"),$C(124),9)=""),'(+$P(vobj(this,"v5"),$C(124),9)=$P(vobj(this,"v5"),$C(124),9))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),9)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),9))
 .	S X=$P(vobj(this,"v5"),$C(124),9) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("PX",$$^MSG(742,"N"))
 .	I '($P(vobj(this,"v5"),$C(124),8)=""),'(+$P(vobj(this,"v5"),$C(124),8)=$P(vobj(this,"v5"),$C(124),8))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),8)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),8))
 .	S X=$P(vobj(this,"v5"),$C(124),8) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("PY",$$^MSG(742,"N"))
 .	I '($P(vobj(this,"v5"),$C(124),13)=""),'(+$P(vobj(this,"v5"),$C(124),13)=$P(vobj(this,"v5"),$C(124),13))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),13)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),13))
 .	S X=$P(vobj(this,"v5"),$C(124),13) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("RHTMAR",$$^MSG(742,"N"))
 .	I ($L($P(vobj(this,"v5"),$C(124),3))>1) D vRCvalidateDDerr("RULER",$$^MSG(1076,1))
 .	I '($P(vobj(this,"v5"),$C(124),12)=""),'(+$P(vobj(this,"v5"),$C(124),12)=$P(vobj(this,"v5"),$C(124),12))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),12)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),12))
 .	S X=$P(vobj(this,"v5"),$C(124),12) I '(X=""),(X'?1N) D vRCvalidateDDerr("STATUS",$$^MSG(742,"N"))
 .	I ($L($P(vobj(this,"v5"),$C(124),4))>40) D vRCvalidateDDerr("VIDEO",$$^MSG(1076,40))
 .	I '($P(vobj(this,"v5"),$C(124),2)=""),'(+$P(vobj(this,"v5"),$C(124),2)=$P(vobj(this,"v5"),$C(124),2))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),2)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),2))
 .	S X=$P(vobj(this,"v5"),$C(124),2) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("XORIGIN",$$^MSG(742,"N"))
 .	I '($P(vobj(this,"v5"),$C(124),1)=""),'(+$P(vobj(this,"v5"),$C(124),1)=$P(vobj(this,"v5"),$C(124),1))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),1)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),1))
 .	S X=$P(vobj(this,"v5"),$C(124),1) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("YORIGIN",$$^MSG(742,"N"))
 .	Q 
 I ($D(vobj(this,"v1"))#2) D
 .	 S:'$D(vobj(this,"v1")) vobj(this,"v1")=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),-1)),1:"")
 .	I ($P(vobj(this,"v1"),$C(124),1)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),1),"U")) D vRCvalidateDDerr("LNK1",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),1))>12) D vRCvalidateDDerr("LNK1",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),10)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),10),"U")) D vRCvalidateDDerr("LNK10",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),10))>12) D vRCvalidateDDerr("LNK10",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),11)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),11),"U")) D vRCvalidateDDerr("LNK11",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),11))>12) D vRCvalidateDDerr("LNK11",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),12)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),12),"U")) D vRCvalidateDDerr("LNK12",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),12))>12) D vRCvalidateDDerr("LNK12",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),13)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),13),"U")) D vRCvalidateDDerr("LNK13",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),13))>12) D vRCvalidateDDerr("LNK13",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),14)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),14),"U")) D vRCvalidateDDerr("LNK14",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),14))>12) D vRCvalidateDDerr("LNK14",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),15)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),15),"U")) D vRCvalidateDDerr("LNK15",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),15))>12) D vRCvalidateDDerr("LNK15",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),16)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),16),"U")) D vRCvalidateDDerr("LNK16",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),16))>12) D vRCvalidateDDerr("LNK16",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),17)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),17),"U")) D vRCvalidateDDerr("LNK17",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),17))>12) D vRCvalidateDDerr("LNK17",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),18)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),18),"U")) D vRCvalidateDDerr("LNK18",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),18))>12) D vRCvalidateDDerr("LNK18",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),19)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),19),"U")) D vRCvalidateDDerr("LNK19",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),19))>12) D vRCvalidateDDerr("LNK19",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),2)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),2),"U")) D vRCvalidateDDerr("LNK2",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),2))>12) D vRCvalidateDDerr("LNK2",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),20)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),20),"U")) D vRCvalidateDDerr("LNK20",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),20))>12) D vRCvalidateDDerr("LNK20",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),21)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),21),"U")) D vRCvalidateDDerr("LNK21",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),21))>12) D vRCvalidateDDerr("LNK21",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),22)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),22),"U")) D vRCvalidateDDerr("LNK22",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),22))>12) D vRCvalidateDDerr("LNK22",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),23)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),23),"U")) D vRCvalidateDDerr("LNK23",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),23))>12) D vRCvalidateDDerr("LNK23",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),24)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),24),"U")) D vRCvalidateDDerr("LNK24",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),24))>12) D vRCvalidateDDerr("LNK24",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),25)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),25),"U")) D vRCvalidateDDerr("LNK25",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),25))>12) D vRCvalidateDDerr("LNK25",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),26)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),26),"U")) D vRCvalidateDDerr("LNK26",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),26))>12) D vRCvalidateDDerr("LNK26",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),27)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),27),"U")) D vRCvalidateDDerr("LNK27",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),27))>12) D vRCvalidateDDerr("LNK27",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),28)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),28),"U")) D vRCvalidateDDerr("LNK28",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),28))>12) D vRCvalidateDDerr("LNK28",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),3)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),3),"U")) D vRCvalidateDDerr("LNK3",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),3))>12) D vRCvalidateDDerr("LNK3",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),4)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),4),"U")) D vRCvalidateDDerr("LNK4",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),4))>12) D vRCvalidateDDerr("LNK4",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),5)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),5),"U")) D vRCvalidateDDerr("LNK5",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),5))>12) D vRCvalidateDDerr("LNK5",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),6)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),6),"U")) D vRCvalidateDDerr("LNK6",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),6))>12) D vRCvalidateDDerr("LNK6",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),7)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),7),"U")) D vRCvalidateDDerr("LNK7",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),7))>12) D vRCvalidateDDerr("LNK7",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),8)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),8),"U")) D vRCvalidateDDerr("LNK8",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),8))>12) D vRCvalidateDDerr("LNK8",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),9)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),9),"U")) D vRCvalidateDDerr("LNK9",$$^MSG(1476))
 .	I ($L($P(vobj(this,"v1"),$C(124),9))>12) D vRCvalidateDDerr("LNK9",$$^MSG(1076,12))
 .	Q 
 I ($D(vobj(this,0))#2) D
 .	 S:'$D(vobj(this,0)) vobj(this,0)=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),0)),1:"")
 .	S X=$P(vobj(this,0),$C(124),11) I '(X=""),'$$vCaEx1() D vRCvalidateDDerr("APL",$$^MSG(1485,X))
 .	I '(($P(vobj(this,0),$C(124),22)=1)!($P(vobj(this,0),$C(124),22)=0)) D vRCvalidateDDerr("CSCMP",$$^MSG(742,"L"))
 .	I '(($P(vobj(this,0),$C(124),18)=1)!($P(vobj(this,0),$C(124),18)=0)) D vRCvalidateDDerr("CURDSP",$$^MSG(742,"L"))
 .	S X=$P(vobj(this,0),$C(124),3) I '(X=""),(X'?1.5N) D vRCvalidateDDerr("DATE",$$^MSG(742,"D"))
 .	I ($L($P(vobj(this,0),$C(124),9))>40) D vRCvalidateDDerr("DESC",$$^MSG(1076,40))
 .	I '(($P(vobj(this,0),$C(124),4)=1)!($P(vobj(this,0),$C(124),4)=0)) D vRCvalidateDDerr("NORPC",$$^MSG(742,"L"))
 .	I '(($P(vobj(this,0),$C(124),17)=1)!($P(vobj(this,0),$C(124),17)=0)) D vRCvalidateDDerr("OOE",$$^MSG(742,"L"))
 .	I ($L($P(vobj(this,0),$C(124),14))>20) D vRCvalidateDDerr("OUTFMT",$$^MSG(1076,20))
 .	I ($P(vobj(this,0),$C(124),1)'=$ZCONVERT($P(vobj(this,0),$C(124),1),"U")) D vRCvalidateDDerr("PFID",$$^MSG(1476))
 .	I ($L($P(vobj(this,0),$C(124),1))>60) D vRCvalidateDDerr("PFID",$$^MSG(1076,60))
 .	I '($P(vobj(this,0),$C(124),13)=""),'(+$P(vobj(this,0),$C(124),13)=$P(vobj(this,0),$C(124),13))  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),13)=$$vRCtrimNumber($P(vobj(this,0),$C(124),13))
 .	S X=$P(vobj(this,0),$C(124),13) I '(X=""),(X'?1.6N),(X'?1"-"1.5N) D vRCvalidateDDerr("PROJ",$$^MSG(742,"N"))
 .	I '($P(vobj(this,0),$C(124),7)=""),'(+$P(vobj(this,0),$C(124),7)=$P(vobj(this,0),$C(124),7))  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),7)=$$vRCtrimNumber($P(vobj(this,0),$C(124),7))
 .	S X=$P(vobj(this,0),$C(124),7) I '(X=""),(X'?1.2N),(X'?1"-"1.1N) D vRCvalidateDDerr("REPEAT",$$^MSG(742,"N"))
 .	I ($L($P(vobj(this,0),$C(124),5))>2) D vRCvalidateDDerr("REPREQ",$$^MSG(1076,2))
 .	S X=$P(vobj(this,0),$C(124),16) I '(X=""),'($D(^DBCTL("SYS","RESFLG",X))#2) D vRCvalidateDDerr("RESFLG",$$^MSG(1485,X))
 .	S X=$P(vobj(this,0),$C(124),8) I '(X=""),'((","_"0,1"_",")[(","_X_",")) D vRCvalidateDDerr("SCRCLR",$$^MSG(1485,X))
 .	I '(($P(vobj(this,0),$C(124),6)=1)!($P(vobj(this,0),$C(124),6)=0)) D vRCvalidateDDerr("SCRMOD",$$^MSG(742,"L"))
 .	S X=$P(vobj(this,0),$C(124),12) I '(X=""),'$$vCaEx2() D vRCvalidateDDerr("SYS",$$^MSG(1485,X))
 .	I ($L($P(vobj(this,0),$C(124),15))>20) D vRCvalidateDDerr("UID",$$^MSG(1076,20))
 .	I ($L($P(vobj(this,0),$C(124),10))>6) D vRCvalidateDDerr("VER",$$^MSG(1076,6))
 .	I ($L($P(vobj(this,0),$C(124),2))>8) D vRCvalidateDDerr("VPGM",$$^MSG(1076,8))
 .	Q 
 I ($L(vobj(this,-3))>10) D vRCvalidateDDerr("LIBS",$$^MSG(1076,10))
 I ($L(vobj(this,-4))>12) D vRCvalidateDDerr("SID",$$^MSG(1076,12))
 I ($D(vobj(this))#2)!'($order(vobj(this,""))="") D
 .	I ($L($P(vobj(this),$C(124),1))>40) D vRCvalidateDDerr("DESC2",$$^MSG(1076,40))
 .	Q 
 Q 
 ;
vRCvalidateDD1(this) ; 
  S:'$D(vobj(this,"v5")) vobj(this,"v5")=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),-5)),1:"")
  S:'$D(vobj(this,"v1")) vobj(this,"v1")=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),-1)),1:"")
  S:'$D(vobj(this,0)) vobj(this,0)=$S(vobj(this,-2):$G(^DBTBL(vobj(this,-3),2,vobj(this,-4),0)),1:"")
 N ER S ER=0
 N RM S RM=""
 N errmsg N X
 I ($D(vobj(this,"v5"))#2) D
 .	I ($D(vobj(this,-100,"v5","BUFFERS"))&($P($E($G(vobj(this,-100,"v5","BUFFERS")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),5))),'($P(vobj(this,"v5"),$C(124),5)=""),'(+$P(vobj(this,"v5"),$C(124),5)=$P(vobj(this,"v5"),$C(124),5))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),5)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),5))
 .	I ($D(vobj(this,-100,"v5","BUFFERS"))&($P($E($G(vobj(this,-100,"v5","BUFFERS")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),5))) S X=$P(vobj(this,"v5"),$C(124),5) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("BUFFERS",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,"v5","FORMHDG"))&($P($E($G(vobj(this,-100,"v5","FORMHDG")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),10))) I ($L($P(vobj(this,"v5"),$C(124),10))>40) D vRCvalidateDDerr("FORMHDG",$$^MSG(1076,40))
 .	I ($D(vobj(this,-100,"v5","LASTFID"))&($P($E($G(vobj(this,-100,"v5","LASTFID")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),11))) I ($L($P(vobj(this,"v5"),$C(124),11))>12) D vRCvalidateDDerr("LASTFID",$$^MSG(1076,12))
 .	I ($D(vobj(this,-100,"v5","PX"))&($P($E($G(vobj(this,-100,"v5","PX")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),9))),'($P(vobj(this,"v5"),$C(124),9)=""),'(+$P(vobj(this,"v5"),$C(124),9)=$P(vobj(this,"v5"),$C(124),9))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),9)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),9))
 .	I ($D(vobj(this,-100,"v5","PX"))&($P($E($G(vobj(this,-100,"v5","PX")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),9))) S X=$P(vobj(this,"v5"),$C(124),9) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("PX",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,"v5","PY"))&($P($E($G(vobj(this,-100,"v5","PY")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),8))),'($P(vobj(this,"v5"),$C(124),8)=""),'(+$P(vobj(this,"v5"),$C(124),8)=$P(vobj(this,"v5"),$C(124),8))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),8)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),8))
 .	I ($D(vobj(this,-100,"v5","PY"))&($P($E($G(vobj(this,-100,"v5","PY")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),8))) S X=$P(vobj(this,"v5"),$C(124),8) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("PY",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,"v5","RHTMAR"))&($P($E($G(vobj(this,-100,"v5","RHTMAR")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),13))),'($P(vobj(this,"v5"),$C(124),13)=""),'(+$P(vobj(this,"v5"),$C(124),13)=$P(vobj(this,"v5"),$C(124),13))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),13)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),13))
 .	I ($D(vobj(this,-100,"v5","RHTMAR"))&($P($E($G(vobj(this,-100,"v5","RHTMAR")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),13))) S X=$P(vobj(this,"v5"),$C(124),13) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("RHTMAR",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,"v5","RULER"))&($P($E($G(vobj(this,-100,"v5","RULER")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),3))) I ($L($P(vobj(this,"v5"),$C(124),3))>1) D vRCvalidateDDerr("RULER",$$^MSG(1076,1))
 .	I ($D(vobj(this,-100,"v5","STATUS"))&($P($E($G(vobj(this,-100,"v5","STATUS")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),12))),'($P(vobj(this,"v5"),$C(124),12)=""),'(+$P(vobj(this,"v5"),$C(124),12)=$P(vobj(this,"v5"),$C(124),12))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),12)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),12))
 .	I ($D(vobj(this,-100,"v5","STATUS"))&($P($E($G(vobj(this,-100,"v5","STATUS")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),12))) S X=$P(vobj(this,"v5"),$C(124),12) I '(X=""),(X'?1N) D vRCvalidateDDerr("STATUS",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,"v5","VIDEO"))&($P($E($G(vobj(this,-100,"v5","VIDEO")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),4))) I ($L($P(vobj(this,"v5"),$C(124),4))>40) D vRCvalidateDDerr("VIDEO",$$^MSG(1076,40))
 .	I ($D(vobj(this,-100,"v5","XORIGIN"))&($P($E($G(vobj(this,-100,"v5","XORIGIN")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),2))),'($P(vobj(this,"v5"),$C(124),2)=""),'(+$P(vobj(this,"v5"),$C(124),2)=$P(vobj(this,"v5"),$C(124),2))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),2)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),2))
 .	I ($D(vobj(this,-100,"v5","XORIGIN"))&($P($E($G(vobj(this,-100,"v5","XORIGIN")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),2))) S X=$P(vobj(this,"v5"),$C(124),2) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("XORIGIN",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,"v5","YORIGIN"))&($P($E($G(vobj(this,-100,"v5","YORIGIN")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),1))),'($P(vobj(this,"v5"),$C(124),1)=""),'(+$P(vobj(this,"v5"),$C(124),1)=$P(vobj(this,"v5"),$C(124),1))  S vobj(this,-100,"v5")="" S $P(vobj(this,"v5"),$C(124),1)=$$vRCtrimNumber($P(vobj(this,"v5"),$C(124),1))
 .	I ($D(vobj(this,-100,"v5","YORIGIN"))&($P($E($G(vobj(this,-100,"v5","YORIGIN")),5,9999),$C(124))'=$P(vobj(this,"v5"),$C(124),1))) S X=$P(vobj(this,"v5"),$C(124),1) I '(X=""),(X'?1.3N),(X'?1"-"1.2N) D vRCvalidateDDerr("YORIGIN",$$^MSG(742,"N"))
 .	Q 
 I ($D(vobj(this,"v1"))#2) D
 .	I ($P(vobj(this,"v1"),$C(124),1)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),1),"U")) D vRCvalidateDDerr("LNK1",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK1"))&($P($E($G(vobj(this,-100,"v1","LNK1")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),1))) I ($L($P(vobj(this,"v1"),$C(124),1))>12) D vRCvalidateDDerr("LNK1",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),10)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),10),"U")) D vRCvalidateDDerr("LNK10",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK10"))&($P($E($G(vobj(this,-100,"v1","LNK10")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),10))) I ($L($P(vobj(this,"v1"),$C(124),10))>12) D vRCvalidateDDerr("LNK10",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),11)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),11),"U")) D vRCvalidateDDerr("LNK11",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK11"))&($P($E($G(vobj(this,-100,"v1","LNK11")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),11))) I ($L($P(vobj(this,"v1"),$C(124),11))>12) D vRCvalidateDDerr("LNK11",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),12)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),12),"U")) D vRCvalidateDDerr("LNK12",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK12"))&($P($E($G(vobj(this,-100,"v1","LNK12")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),12))) I ($L($P(vobj(this,"v1"),$C(124),12))>12) D vRCvalidateDDerr("LNK12",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),13)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),13),"U")) D vRCvalidateDDerr("LNK13",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK13"))&($P($E($G(vobj(this,-100,"v1","LNK13")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),13))) I ($L($P(vobj(this,"v1"),$C(124),13))>12) D vRCvalidateDDerr("LNK13",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),14)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),14),"U")) D vRCvalidateDDerr("LNK14",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK14"))&($P($E($G(vobj(this,-100,"v1","LNK14")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),14))) I ($L($P(vobj(this,"v1"),$C(124),14))>12) D vRCvalidateDDerr("LNK14",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),15)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),15),"U")) D vRCvalidateDDerr("LNK15",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK15"))&($P($E($G(vobj(this,-100,"v1","LNK15")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),15))) I ($L($P(vobj(this,"v1"),$C(124),15))>12) D vRCvalidateDDerr("LNK15",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),16)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),16),"U")) D vRCvalidateDDerr("LNK16",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK16"))&($P($E($G(vobj(this,-100,"v1","LNK16")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),16))) I ($L($P(vobj(this,"v1"),$C(124),16))>12) D vRCvalidateDDerr("LNK16",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),17)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),17),"U")) D vRCvalidateDDerr("LNK17",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK17"))&($P($E($G(vobj(this,-100,"v1","LNK17")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),17))) I ($L($P(vobj(this,"v1"),$C(124),17))>12) D vRCvalidateDDerr("LNK17",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),18)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),18),"U")) D vRCvalidateDDerr("LNK18",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK18"))&($P($E($G(vobj(this,-100,"v1","LNK18")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),18))) I ($L($P(vobj(this,"v1"),$C(124),18))>12) D vRCvalidateDDerr("LNK18",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),19)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),19),"U")) D vRCvalidateDDerr("LNK19",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK19"))&($P($E($G(vobj(this,-100,"v1","LNK19")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),19))) I ($L($P(vobj(this,"v1"),$C(124),19))>12) D vRCvalidateDDerr("LNK19",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),2)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),2),"U")) D vRCvalidateDDerr("LNK2",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK2"))&($P($E($G(vobj(this,-100,"v1","LNK2")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),2))) I ($L($P(vobj(this,"v1"),$C(124),2))>12) D vRCvalidateDDerr("LNK2",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),20)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),20),"U")) D vRCvalidateDDerr("LNK20",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK20"))&($P($E($G(vobj(this,-100,"v1","LNK20")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),20))) I ($L($P(vobj(this,"v1"),$C(124),20))>12) D vRCvalidateDDerr("LNK20",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),21)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),21),"U")) D vRCvalidateDDerr("LNK21",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK21"))&($P($E($G(vobj(this,-100,"v1","LNK21")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),21))) I ($L($P(vobj(this,"v1"),$C(124),21))>12) D vRCvalidateDDerr("LNK21",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),22)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),22),"U")) D vRCvalidateDDerr("LNK22",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK22"))&($P($E($G(vobj(this,-100,"v1","LNK22")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),22))) I ($L($P(vobj(this,"v1"),$C(124),22))>12) D vRCvalidateDDerr("LNK22",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),23)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),23),"U")) D vRCvalidateDDerr("LNK23",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK23"))&($P($E($G(vobj(this,-100,"v1","LNK23")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),23))) I ($L($P(vobj(this,"v1"),$C(124),23))>12) D vRCvalidateDDerr("LNK23",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),24)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),24),"U")) D vRCvalidateDDerr("LNK24",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK24"))&($P($E($G(vobj(this,-100,"v1","LNK24")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),24))) I ($L($P(vobj(this,"v1"),$C(124),24))>12) D vRCvalidateDDerr("LNK24",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),25)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),25),"U")) D vRCvalidateDDerr("LNK25",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK25"))&($P($E($G(vobj(this,-100,"v1","LNK25")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),25))) I ($L($P(vobj(this,"v1"),$C(124),25))>12) D vRCvalidateDDerr("LNK25",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),26)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),26),"U")) D vRCvalidateDDerr("LNK26",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK26"))&($P($E($G(vobj(this,-100,"v1","LNK26")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),26))) I ($L($P(vobj(this,"v1"),$C(124),26))>12) D vRCvalidateDDerr("LNK26",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),27)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),27),"U")) D vRCvalidateDDerr("LNK27",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK27"))&($P($E($G(vobj(this,-100,"v1","LNK27")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),27))) I ($L($P(vobj(this,"v1"),$C(124),27))>12) D vRCvalidateDDerr("LNK27",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),28)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),28),"U")) D vRCvalidateDDerr("LNK28",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK28"))&($P($E($G(vobj(this,-100,"v1","LNK28")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),28))) I ($L($P(vobj(this,"v1"),$C(124),28))>12) D vRCvalidateDDerr("LNK28",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),3)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),3),"U")) D vRCvalidateDDerr("LNK3",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK3"))&($P($E($G(vobj(this,-100,"v1","LNK3")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),3))) I ($L($P(vobj(this,"v1"),$C(124),3))>12) D vRCvalidateDDerr("LNK3",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),4)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),4),"U")) D vRCvalidateDDerr("LNK4",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK4"))&($P($E($G(vobj(this,-100,"v1","LNK4")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),4))) I ($L($P(vobj(this,"v1"),$C(124),4))>12) D vRCvalidateDDerr("LNK4",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),5)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),5),"U")) D vRCvalidateDDerr("LNK5",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK5"))&($P($E($G(vobj(this,-100,"v1","LNK5")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),5))) I ($L($P(vobj(this,"v1"),$C(124),5))>12) D vRCvalidateDDerr("LNK5",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),6)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),6),"U")) D vRCvalidateDDerr("LNK6",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK6"))&($P($E($G(vobj(this,-100,"v1","LNK6")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),6))) I ($L($P(vobj(this,"v1"),$C(124),6))>12) D vRCvalidateDDerr("LNK6",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),7)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),7),"U")) D vRCvalidateDDerr("LNK7",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK7"))&($P($E($G(vobj(this,-100,"v1","LNK7")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),7))) I ($L($P(vobj(this,"v1"),$C(124),7))>12) D vRCvalidateDDerr("LNK7",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),8)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),8),"U")) D vRCvalidateDDerr("LNK8",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK8"))&($P($E($G(vobj(this,-100,"v1","LNK8")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),8))) I ($L($P(vobj(this,"v1"),$C(124),8))>12) D vRCvalidateDDerr("LNK8",$$^MSG(1076,12))
 .	I ($P(vobj(this,"v1"),$C(124),9)'=$ZCONVERT($P(vobj(this,"v1"),$C(124),9),"U")) D vRCvalidateDDerr("LNK9",$$^MSG(1476))
 .	I ($D(vobj(this,-100,"v1","LNK9"))&($P($E($G(vobj(this,-100,"v1","LNK9")),5,9999),$C(124))'=$P(vobj(this,"v1"),$C(124),9))) I ($L($P(vobj(this,"v1"),$C(124),9))>12) D vRCvalidateDDerr("LNK9",$$^MSG(1076,12))
 .	Q 
 I ($D(vobj(this,0))#2) D
 .	I ($D(vobj(this,-100,0,"APL"))&($P($E($G(vobj(this,-100,0,"APL")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),11))) S X=$P(vobj(this,0),$C(124),11) I '(X=""),'$$vCaEx3() D vRCvalidateDDerr("APL",$$^MSG(1485,X))
 .	I ($D(vobj(this,-100,0,"CSCMP"))&($P($E($G(vobj(this,-100,0,"CSCMP")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),22))) I '(($P(vobj(this,0),$C(124),22)=1)!($P(vobj(this,0),$C(124),22)=0)) D vRCvalidateDDerr("CSCMP",$$^MSG(742,"L"))
 .	I ($D(vobj(this,-100,0,"CURDSP"))&($P($E($G(vobj(this,-100,0,"CURDSP")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),18))) I '(($P(vobj(this,0),$C(124),18)=1)!($P(vobj(this,0),$C(124),18)=0)) D vRCvalidateDDerr("CURDSP",$$^MSG(742,"L"))
 .	I ($D(vobj(this,-100,0,"DATE"))&($P($E($G(vobj(this,-100,0,"DATE")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),3))) S X=$P(vobj(this,0),$C(124),3) I '(X=""),(X'?1.5N) D vRCvalidateDDerr("DATE",$$^MSG(742,"D"))
 .	I ($D(vobj(this,-100,0,"DESC"))&($P($E($G(vobj(this,-100,0,"DESC")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),9))) I ($L($P(vobj(this,0),$C(124),9))>40) D vRCvalidateDDerr("DESC",$$^MSG(1076,40))
 .	I ($D(vobj(this,-100,0,"NORPC"))&($P($E($G(vobj(this,-100,0,"NORPC")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),4))) I '(($P(vobj(this,0),$C(124),4)=1)!($P(vobj(this,0),$C(124),4)=0)) D vRCvalidateDDerr("NORPC",$$^MSG(742,"L"))
 .	I ($D(vobj(this,-100,0,"OOE"))&($P($E($G(vobj(this,-100,0,"OOE")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),17))) I '(($P(vobj(this,0),$C(124),17)=1)!($P(vobj(this,0),$C(124),17)=0)) D vRCvalidateDDerr("OOE",$$^MSG(742,"L"))
 .	I ($D(vobj(this,-100,0,"OUTFMT"))&($P($E($G(vobj(this,-100,0,"OUTFMT")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),14))) I ($L($P(vobj(this,0),$C(124),14))>20) D vRCvalidateDDerr("OUTFMT",$$^MSG(1076,20))
 .	I ($P(vobj(this,0),$C(124),1)'=$ZCONVERT($P(vobj(this,0),$C(124),1),"U")) D vRCvalidateDDerr("PFID",$$^MSG(1476))
 .	I ($D(vobj(this,-100,0,"PFID"))&($P($E($G(vobj(this,-100,0,"PFID")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),1))) I ($L($P(vobj(this,0),$C(124),1))>60) D vRCvalidateDDerr("PFID",$$^MSG(1076,60))
 .	I ($D(vobj(this,-100,0,"PROJ"))&($P($E($G(vobj(this,-100,0,"PROJ")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),13))),'($P(vobj(this,0),$C(124),13)=""),'(+$P(vobj(this,0),$C(124),13)=$P(vobj(this,0),$C(124),13))  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),13)=$$vRCtrimNumber($P(vobj(this,0),$C(124),13))
 .	I ($D(vobj(this,-100,0,"PROJ"))&($P($E($G(vobj(this,-100,0,"PROJ")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),13))) S X=$P(vobj(this,0),$C(124),13) I '(X=""),(X'?1.6N),(X'?1"-"1.5N) D vRCvalidateDDerr("PROJ",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,0,"REPEAT"))&($P($E($G(vobj(this,-100,0,"REPEAT")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),7))),'($P(vobj(this,0),$C(124),7)=""),'(+$P(vobj(this,0),$C(124),7)=$P(vobj(this,0),$C(124),7))  S vobj(this,-100,0)="" S $P(vobj(this,0),$C(124),7)=$$vRCtrimNumber($P(vobj(this,0),$C(124),7))
 .	I ($D(vobj(this,-100,0,"REPEAT"))&($P($E($G(vobj(this,-100,0,"REPEAT")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),7))) S X=$P(vobj(this,0),$C(124),7) I '(X=""),(X'?1.2N),(X'?1"-"1.1N) D vRCvalidateDDerr("REPEAT",$$^MSG(742,"N"))
 .	I ($D(vobj(this,-100,0,"REPREQ"))&($P($E($G(vobj(this,-100,0,"REPREQ")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),5))) I ($L($P(vobj(this,0),$C(124),5))>2) D vRCvalidateDDerr("REPREQ",$$^MSG(1076,2))
 .	I ($D(vobj(this,-100,0,"RESFLG"))&($P($E($G(vobj(this,-100,0,"RESFLG")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),16))) S X=$P(vobj(this,0),$C(124),16) I '(X=""),'($D(^DBCTL("SYS","RESFLG",X))#2) D vRCvalidateDDerr("RESFLG",$$^MSG(1485,X))
 .	I ($D(vobj(this,-100,0,"SCRCLR"))&($P($E($G(vobj(this,-100,0,"SCRCLR")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),8))) S X=$P(vobj(this,0),$C(124),8) I '(X=""),'((","_"0,1"_",")[(","_X_",")) D vRCvalidateDDerr("SCRCLR",$$^MSG(1485,X))
 .	I ($D(vobj(this,-100,0,"SCRMOD"))&($P($E($G(vobj(this,-100,0,"SCRMOD")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),6))) I '(($P(vobj(this,0),$C(124),6)=1)!($P(vobj(this,0),$C(124),6)=0)) D vRCvalidateDDerr("SCRMOD",$$^MSG(742,"L"))
 .	I ($D(vobj(this,-100,0,"SYS"))&($P($E($G(vobj(this,-100,0,"SYS")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),12))) S X=$P(vobj(this,0),$C(124),12) I '(X=""),'$$vCaEx4() D vRCvalidateDDerr("SYS",$$^MSG(1485,X))
 .	I ($D(vobj(this,-100,0,"UID"))&($P($E($G(vobj(this,-100,0,"UID")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),15))) I ($L($P(vobj(this,0),$C(124),15))>20) D vRCvalidateDDerr("UID",$$^MSG(1076,20))
 .	I ($D(vobj(this,-100,0,"VER"))&($P($E($G(vobj(this,-100,0,"VER")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),10))) I ($L($P(vobj(this,0),$C(124),10))>6) D vRCvalidateDDerr("VER",$$^MSG(1076,6))
 .	I ($D(vobj(this,-100,0,"VPGM"))&($P($E($G(vobj(this,-100,0,"VPGM")),5,9999),$C(124))'=$P(vobj(this,0),$C(124),2))) I ($L($P(vobj(this,0),$C(124),2))>8) D vRCvalidateDDerr("VPGM",$$^MSG(1076,8))
 .	Q 
 I ($D(vobj(this,-100,"1*","LIBS"))&($P($E($G(vobj(this,-100,"1*","LIBS")),5,9999),$C(124))'=vobj(this,-3))) I ($L(vobj(this,-3))>10) D vRCvalidateDDerr("LIBS",$$^MSG(1076,10))
 I ($D(vobj(this,-100,"2*","SID"))&($P($E($G(vobj(this,-100,"2*","SID")),5,9999),$C(124))'=vobj(this,-4))) I ($L(vobj(this,-4))>12) D vRCvalidateDDerr("SID",$$^MSG(1076,12))
 I ($D(vobj(this))#2)!'($order(vobj(this,""))="") D
 .	I ($D(vobj(this,-100,"0*","DESC2"))&($P($E($G(vobj(this,-100,"0*","DESC2")),5,9999),$C(124))'=$P(vobj(this),$C(124),1))) I ($L($P(vobj(this),$C(124),1))>40) D vRCvalidateDDerr("DESC2",$$^MSG(1076,40))
 .	Q 
 Q 
 ;
vRCvalidateDDerr(column,errmsg) ; 
 N ER S ER=0
 N RM S RM=""
 D SETERR^DBSEXECU("DBTBL2","MSG",979,"DBTBL2."_column_" "_errmsg)
 I ER D throwError($get(RM))
 Q 
 ;
vRCtrimNumber(str) ; 
 I ($E(str,1)="0") S str=$$vStrTrim(str,-1,"0") I (str="") S str="0"
 I (str["."),($E(str,$L(str))="0") S str=$$RTCHR^%ZFUNC(str,"0") I ($E(str,$L(str))=".") S str=$E(str,1,$L(str)-1) I (str="") S str="0"
 Q str
 ;
vRCkeyChanged(this,vRCparams,vRCaudit) ; 
 N vTp
 N newkeys N oldkeys N vRCauditIns
 N newKey1 S newKey1=vobj(this,-3)
 N oldKey1 S oldKey1=$S($D(vobj(this,-100,"1*","LIBS")):$P($E(vobj(this,-100,"1*","LIBS"),5,9999),$C(124)),1:vobj(this,-3))
 N newKey2 S newKey2=vobj(this,-4)
 N oldKey2 S oldKey2=$S($D(vobj(this,-100,"2*","SID")):$P($E(vobj(this,-100,"2*","SID"),5,9999),$C(124)),1:vobj(this,-4))
  N V1,V2 S V1=vobj(this,-3),V2=vobj(this,-4) I ($D(^DBTBL(V1,2,V2))) D throwError($$^MSG(2327))
 S newkeys=newKey1_","_newKey2
 S oldkeys=oldKey1_","_oldKey2
  S vobj(this,-3)=oldKey1
  S vobj(this,-4)=oldKey2
 S vRCparams=$$setPar^UCUTILN(vRCparams,"NOINDEX")
 D vRCforceLoad(this)
 I (("/"_vRCparams_"/")["/VALREQ/") D vRCchkReqForInsert(this)
 I (("/"_vRCparams_"/")["/VALDD/") D vRCvalidateDD(this,1)
 D vRCmiscValidations(this,vRCparams,1)
 D vRCupdateDB(this,1,vRCparams,.vRCaudit,.vRCauditIns)
  S vobj(this,-3)=newKey1
  S vobj(this,-4)=newKey2
 N newrec S newrec=$$vReCp1(this)
 S vobj(newrec,-2)=0
 S vTp=($TL=0) TS:vTp (vobj):transactionid="CS" D vSave^RecordDBTBL2(newrec,$$initPar^UCUTILN($$initPar^UCUTILN("/NOVAL/NOCASDEL/NOJOURNAL/NOTRIGBEF/NOTRIGAFT/"))) K vobj(newrec,-100) S vobj(newrec,-2)=1 TC:vTp  
 D
 .	N %O S %O=1
 .	N ER S ER=0
 .	N RM S RM=""
 .	;   #ACCEPT Date=10/24/2008; Pgm=RussellDS; CR=30801; Group=ACCESS
 .	D CASUPD^DBSEXECU("DBTBL2",oldkeys,newkeys)
 .	I ER D throwError($get(RM))
 .	Q 
  S vobj(this,-3)=oldKey1
  S vobj(this,-4)=oldKey2
 S vRCparams=$$initPar^UCUTILN("/NOVAL/NOCASDEL/NOJOURNAL/NOTRIGBEF/NOTRIGAFT/")
 D vRCdelete(this,vRCparams,.vRCaudit,1)
  S vobj(this,-3)=newKey1
  S vobj(this,-4)=newKey2
 K vobj(+$G(newrec)) Q 
 ;
throwError(MSG) ; 
 S $ZE="0,"_$ZPOS_","_"%PSL-E-DBFILER,"_$translate(MSG,",","~"),$EC=",U1001,"
 Q 
 ; ----------------
 ;  #OPTION ResultClass 1
vStrRep(object,p1,p2,p3,p4,qt) ; String.replace
 ;
 ;  #OPTIMIZE FUNCTIONS OFF
 ;
 I p3<0 Q object
 I $L(p1)=1,$L(p2)<2,'p3,'p4,(qt="") Q $translate(object,p1,p2)
 ;
 N y S y=0
 F  S y=$$vStrFnd(object,p1,y,p4,qt) Q:y=0  D
 .	S object=$E(object,1,y-$L(p1)-1)_p2_$E(object,y,1048575)
 .	S y=y+$L(p2)-$L(p1)
 .	I p3 S p3=p3-1 I p3=0 S y=$L(object)+1
 .	Q 
 Q object
 ; ----------------
 ;  #OPTION ResultClass 1
vCaEx1() ; {Cache}%CACHE("STBLSCASYS").isDefined("STBLSCASYS","SYS=:X")
 N vret
 ;
 ;  #OPTIMIZE FUNCTIONS OFF
 N vRec,vop1 S vRec=$$vCa2(X,.vop1)
 S vret=$G(vop1)=1 Q vret
 ; ----------------
 ;  #OPTION ResultClass 1
vCaEx2() ; {Cache}%CACHE("STBLSCASYS").isDefined("STBLSCASYS","SYS=:X")
 N vret
 ;
 ;  #OPTIMIZE FUNCTIONS OFF
 N vRec,vop1 S vRec=$$vCa2(X,.vop1)
 S vret=$G(vop1)=1 Q vret
 ; ----------------
 ;  #OPTION ResultClass 1
vCaEx3() ; {Cache}%CACHE("STBLSCASYS").isDefined("STBLSCASYS","SYS=:X")
 N vret
 ;
 ;  #OPTIMIZE FUNCTIONS OFF
 N vRec,vop1 S vRec=$$vCa2(X,.vop1)
 S vret=$G(vop1)=1 Q vret
 ; ----------------
 ;  #OPTION ResultClass 1
vCaEx4() ; {Cache}%CACHE("STBLSCASYS").isDefined("STBLSCASYS","SYS=:X")
 N vret
 ;
 ;  #OPTIMIZE FUNCTIONS OFF
 N vRec,vop1 S vRec=$$vCa2(X,.vop1)
 S vret=$G(vop1)=1 Q vret
 ; ----------------
 ;  #OPTION ResultClass 1
vStrTrim(object,p1,p2) ; String.trim
 ;
 ;  #OPTIMIZE FUNCTIONS OFF
 I p1'<0 S object=$$RTCHR^%ZFUNC(object,p2)
 I p1'>0 F  Q:$E(object,1)'=p2  S object=$E(object,2,1048575)
 Q object
 ; ----------------
 ;  #OPTION ResultClass 1
vStrFnd(object,p1,p2,p3,qt) ; String.find
 ;
 ;  #OPTIMIZE FUNCTIONS OFF
 ;
 I (p1="") Q $S(p2<1:1,1:+p2)
 I p3 S object=$ZCONVERT(object,"U") S p1=$ZCONVERT(p1,"U")
 S p2=$F(object,p1,p2)
 I '(qt=""),$L($E(object,1,p2-1),qt)#2=0 D
 .	F  S p2=$F(object,p1,p2) Q:p2=0!($L($E(object,1,p2-1),qt)#2) 
 .	Q 
 Q p2
 ;
vCa2(v1,v2out) ; voXN = ({Cache}%CACHE("STBLSCASYS").getRecord(STBLSCASYS,1)
 ;
 I '$D(%CACHE("STBLSCASYS",v1)) D
 .  I $G(%CACHE("STBLSCASYS"))>100 KILL %CACHE("STBLSCASYS")
 .  S %CACHE("STBLSCASYS")=$G(%CACHE("STBLSCASYS"))+1
 .  S %CACHE("STBLSCASYS",v1)=$$vRCgetRecord1Opt^RecordSTBLSCASYS(v1,0,.v2out),%CACHE("STBLSCASYS",v1,-2)=v2out
 ;
 ;
 E  S v2out=%CACHE("STBLSCASYS",v1,-2)
 Q %CACHE("STBLSCASYS",v1)
 ;
vReCp1(v1) ; RecordDBTBL2.copy: DBTBL2
 ;
 N vNod,vOid
 I $G(vobj(v1,-2)) D
 . S:'$D(vobj(v1,"v1")) vobj(v1,"v1")=$G(^DBTBL(vobj(v1,-3),2,vobj(v1,-4),-1))
 . S:'$D(vobj(v1,"v5")) vobj(v1,"v5")=$G(^DBTBL(vobj(v1,-3),2,vobj(v1,-4),-5))
 .	F vNod=0 S:'$D(vobj(v1,vNod)) vobj(v1,vNod)=$G(^DBTBL(vobj(v1,-3),2,vobj(v1,-4),vNod))
 S vOid=$$copy^UCGMR(v1)
 Q vOid
